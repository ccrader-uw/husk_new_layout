#:import Clock kivy.clock.Clock
#:import threading threading
#:import partial functools.partial
<Touchpanel>:
    canvas:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            pos: self.pos
            size: self.size
            source: 'images/background.png' 
    # Controls
    BoxLayout:
        cols: 3
        orientation: 'horizontal'
        pos: 20, 50
        rows: 5
        size: 560, 400
        size_hint: None, None
        spacing: 20
        BoxLayout:
            spacing: 20
            orientation: 'vertical'
            Button:
                background_normal: 'images/labels/display-label.png'
                background_down: 'images/labels/display-label.png'
                id: display_label
                #size: 172, 66
                #size_hint: None, None
            PowerButton:
                background_normal: 'images/buttons/off/projectoron.png'
                background_down: 'images/buttons/on/projectoron.png'
                id: power
                on_state: self.start_projector() if (self.state == "down") else self.stop_projector()
                state: 'down' if app.projector.power_state == True else 'normal'
                #size: 172, 66
                #size_hint: None, None
            ToggleButton:
                background_normal: 'images/buttons/off/projectoroff.png'
                background_down: 'images/buttons/on/projectoroff.png'
                id: power_off
                #size: 172, 66
                #size_hint: None, None
            ToggleButton:
                background_normal: 'images/buttons/off/blank.png'
                background_down: 'images/buttons/on/blank.png'
                id: blank 
                state: 'down' if app.image.blanked else 'normal'
                #size: 172, 66
                #size_hint: None, None
            ToggleButton:
                background_normal: 'images/buttons/off/freeze.png'
                background_down: 'images/buttons/on/freeze.png'
                id: freeze
                state: 'down' if app.image.frozen else 'normal'
                #size: 172, 66
        # Input
        BoxLayout:
            orientation: 'vertical'
            spacing: 20
            Button:
                background_normal: 'images/labels/input-label.png'
                background_down: 'images/labels/input-label.png'
                id: input_label
            ToggleButton:
                background_normal: 'images/buttons/off/podium.png'
                background_down: 'images/buttons/on/podium.png'
                id: podium
                state: 'down' if app.input.input == 0 else 'normal'
            ToggleButton:
                background_normal: 'images/buttons/off/usbc.png'
                background_down: 'images/buttons/on/usbc.png'
                id: usbc
                state: 'down' if app.input.input == 2 else 'normal'
            ToggleButton:
                background_normal: 'images/buttons/off/hdmi.png'
                background_down: 'images/buttons/on/hdmi.png'
                id: hdmi
                state: 'down' if app.input.input == 1 else 'normal'
            ToggleButton:
                background_normal: 'images/buttons/off/vga.png'
                background_down: 'images/buttons/on/vga.png'
                id: vga
                state: 'down' if app.input.input == 3 else 'normal'
        # Audio
        BoxLayout:
            orientation: 'vertical'
            spacing: 20
            Button:
                background_normal: 'images/labels/audio-label.png'
                background_down: 'images/labels/audio-label.png'
                size_hint: 1, 0.17
            Slider:
                cursor_height: 21
                cursor_image: 'images/slider/cursor.png'
                cursor_width: 21
                orientation: 'vertical'
                size_hint: 1, 0.66
                value_track: True
                value_track_color: [0, 0, 0, 1]
            ToggleButton:
                background_normal: 'images/buttons/off/mute.png'
                background_down: 'images/buttons/on/unmute.png'
                size_hint: 1, 0.17
            #size_hint: None, None
